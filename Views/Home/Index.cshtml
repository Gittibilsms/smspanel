@{
    var isAdmin = Context.Session.GetInt32("RoleId") == 1; 
}
@section Scripts {
    <script>
        window.localizedText = @Html.Raw(Json.Serialize(new
            {
                Sent = SharedResource.Sent ?? "Sent",
                AwaitingApproval = SharedResource.Awaiting_Approval ?? "Awaiting Approval",
                Failed = SharedResource.Failed ?? "Failed",
                waiting_to_be_sent = SharedResource.Waiting_to_be_sent ?? "Waiting to be sent",
                Approve = SharedResource.Approve ?? "Approve",
                resend = SharedResource.Resend ?? "Resend",
                changeApi = SharedResource.Change_API ?? "Change API",
                cancelorder = SharedResource.Cancel_Order ?? "Cancel Order",
                cancelconfirmation = SharedResource.Are_you_sure_you_want_to_cancel_this_order_ ?? "Are you sure you want to cancel this order?",
                cancelled = SharedResource.Cancelled ?? "Cancelled",
                confirmsend = SharedResource.Confirm_Send ?? "Confirm Send"

            }));
    </script>

}
<script>
    window.ordersControllerUrl = '/Home/GetAllOrders';
    window.ordersDetailsUrl = '/Orders/GetOrderDetails';
    window.ordersCancelUrl = '/Orders/CancelOrder';
    window.getApisUrl = '/Orders/GetApis';
    window.resendUrl = '/Orders/ResendOrder';
</script>
<div class="row">
    <div class="col-xxl-12 d-flex align-items-stretch">
        <div class="card w-100 overflow-hidden rounded-4">
            <div class="card-body position-relative p-4">
                <div class="row">
                    <div class="col-12 col-sm-7">
                        <div class="d-flex align-items-center gap-3 mb-5">
                            <img src="@ViewBag.ProfilePhotoUrl"
                            onerror="this.onerror=null;this.src='/assets/images/avatars/01.png';"
                            class="rounded-circle bg-grd-info p-1" width="60" height="60" alt="User Photo">
                            <div class="">
                                <h6 class="mb-0 fw-semibold ">@SharedResource.Welcome_Back</h6>
                                <h4 class="fw-semibold mb-0 fs-4 mb-0 text-white">@ViewBag.UserName</h4>

                            </div>
                        </div>
                        <div class="d-flex align-items-center gap-5">
                            <div>
                                <h4 class="mb-1 fw-semibold d-flex align-content-center">
                                    <span id="todaySmsCount">0</span> @SharedResource.Order
                                    <i id="todaySmsTrend" class="ti ti-arrow-up-right fs-5 lh-base text-success ms-2"></i>
                                </h4>
                                <p class="mb-3">@SharedResource.todayorders</p>
                                <div class="progress mb-0" style="height:5px;">
                                    <div id="todaySmsProgress" class="progress-bar bg-grd-success" role="progressbar"
                                    style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-sm-5">
                        <div class="welcome-back-img pt-4">
                            <img src="~/assets/images/gallery/welcome-back-3.png" height="180" alt="">
                        </div>
                    </div>
                </div><!--end row-->
            </div>
        </div>
    </div>
    <div class="col-xxl-12 d-flex align-items-stretch">
        <div class=" w-100 overflow-hidden rounded-4">

            <div class="position-relative p-2 mb-4">
                <div class="row g-3 text-center mt-1 mb-1 stats ">
                    <div class="col-md-2 card">
                        <div class="col card-body">
                            <label>@SharedResource.Total</label> <span id="totalCount">0</span>
                        </div>
                    </div>
                    <div class="col-md-2 card">
                        <div class="col card-body">
                            <label>@SharedResource.Delivered </label><span id="deliveredCount">0</span>
                        </div>
                    </div>
                    <div class="col-md-2 card">
                        <div class="col card-body">
                            <label>@SharedResource.Undelivered</label><span id="undeliverableCount">0</span>
                        </div>
                    </div>
                    <div class="col-md-2 card">
                        <div class="col card-body">
                            <label>@SharedResource.On_Hold</label> <span id="onHoldCount">0</span>
                        </div>
                    </div>
                    <div class="col-md-2 card">
                        <div class="col card-body">
                            <label>@SharedResource.Expired</label> <span id="deliveryExpiredCount">0</span>
                        </div>
                    </div>
                    <div class="col-md-2 card">
                        <div class="col card-body">
                            <label>@SharedResource.Refund</label> <span id="refundAmount">0</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="col-xl-4 col-xxl-4 d-flex align-items-stretch">
        <div class="card w-100 rounded-4">
            <div class="card-body">
                <div class="d-flex align-items-start justify-content-between mb-3">
                    <div>
                        <h5 class="mb-0" id="todaySmsCountGraph">0</h5> <!-- Dynamic today count -->
                        <p class="mb-0">@SharedResource.Today_sms_sent</p>
                    </div>
                    <div class="dropdown">
                        <a href="javascript:;" class="dropdown-toggle-nocaret options dropdown-toggle"
                        data-bs-toggle="dropdown">
                            <span class="material-icons-outlined fs-5">more_vert</span>
                        </a>
                    </div>
                </div>
                <div class="chart-container2">
                    <div id="chart2"></div> <!-- Your dynamic chart -->
                </div>
                <div class="text-center mt-3">
                    <p class="mb-0 font-12">
                        <span id="monthlySmsPercent" class="text-success me-1">0%</span> from last month
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-4 col-xxl-4 d-flex align-items-stretch">
        <div class="card w-100 rounded-4">
            <div class="card-body">
                <div class="d-flex flex-column gap-3">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="">
                            <h5 class="mb-0">@SharedResource.Status</h5>
                        </div>
                        <div class="dropdown">
                            <a href="javascript:;" class="dropdown-toggle-nocaret options dropdown-toggle"
                            data-bs-toggle="dropdown">
                                <span class="material-icons-outlined fs-5">more_vert</span>
                            </a>
                        </div>
                    </div>

                    <div class="position-relative">
                        <div class="piechart-legend">
                            <h2 class="mb-1">68%</h2>
                            <h6 class="mb-0">@SharedResource.totalorders</h6>
                        </div>
                        <div id="chart6"></div>
                    </div>

                    <!-- 🚀 Updated: show ALL 5 statuses -->
                    <div class="d-flex flex-column gap-3 mt-3">

                        <div class="d-flex align-items-center justify-content-between">
                            <p class="mb-0 d-flex align-items-center gap-2 w-50">
                                <span class="material-icons-outlined fs-6 text-primary">desktop_windows</span>
                                @SharedResource.Delivered
                            </p>
                            <div>
                                <p class="mb-0" id="deliveredPercent">0%</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center justify-content-between">
                            <p class="mb-0 d-flex align-items-center gap-2 w-50">
                                <span class="material-icons-outlined fs-6 text-danger">report_problem</span>
                                Undelivered
                            </p>
                            <div>
                                <p class="mb-0" id="undeliverablePercent">0%</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center justify-content-between">
                            <p class="mb-0 d-flex align-items-center gap-2 w-50">
                                <span class="material-icons-outlined fs-6 text-warning">pause_circle</span>
                                @SharedResource.On_Hold
                            </p>
                            <div>
                                <p class="mb-0" id="onHoldPercent">0%</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center justify-content-between">
                            <p class="mb-0 d-flex align-items-center gap-2 w-50">
                                <span class="material-icons-outlined fs-6 text-info">hourglass_bottom</span>
                                Expired
                            </p>
                            <div>
                                <p class="mb-0" id="deliveryExpiredPercent">0%</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center justify-content-between">
                            <p class="mb-0 d-flex align-items-center gap-2 w-50">
                                <span class="material-icons-outlined fs-6 text-success">currency_exchange</span>
                                @SharedResource.Refund
                            </p>
                            <div>
                                <p class="mb-0" id="refundPercent">0%</p>
                            </div>
                        </div>

                    </div>
                    <!-- END statuses -->

                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-4 col-xxl-4 d-flex align-items-stretch">
        <div class="card w-100 rounded-4">
            <div class="card-body">
                <div class="text-center">
                    <h6 class="mb-0">@SharedResource.Monthly_SMS_Sent</h6>
                </div>

                <!-- Match JS → use chart7 -->
                <div class="mt-4" id="chart7"></div>

                <!-- Update subtext -->
                <p>@SharedResource.Totalsmssentpermonth</p>

                <!-- Bottom % → this is optional → we can calculate % change -->
                <div class="d-flex align-items-center gap-3 mt-4">
                    <div class="">
                        <h1 class="mb-0 text-primary" id="monthlySmsPercent">0%</h1>
                    </div>
                    <div class="d-flex align-items-center align-self-end">
                        <p class="mb-0 text-success" id="monthlySmsChange">0%</p>
                        <span class="material-icons-outlined text-success" id="monthlySmsArrow">expand_less</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-12 col-xxl-12 d-flex align-items-stretch d-none">
        <div class="card w-100 rounded-4">
            <div class="card-body">
                <div class="d-flex align-items-start justify-content-between mb-3">
                    <div class="">
                        <h5 class="mb-0">@SharedResource.Recent_Orders</h5>
                    </div>
                    @*     <div class="dropdown">
                            <a href="javascript:;" class="dropdown-toggle-nocaret options dropdown-toggle"
                               data-bs-toggle="dropdown">
                                <span class="material-icons-outlined fs-5">more_vert</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="javascript:;">Action</a></li>
                                <li><a class="dropdown-item" href="javascript:;">Another action</a></li>
                                <li><a class="dropdown-item" href="javascript:;">Something else here</a></li>
                            </ul>
                        </div> *@
                </div>
                @*   <div class="order-search position-relative my-3">
                        <input class="form-control rounded-5 px-5" type="text" placeholder="Search">
                        <span class="material-icons-outlined position-absolute ms-3 translate-middle-y start-0 top-50">search</span>
                    </div> *@
                @*         <div class="d-flex align-items-end justify-content-end">
                    <button class="btn btn-outline-secondary mb-2" id="toggleDateFilter">
                        <i class="fadeIn animated bx bx-filter"></i> Filters
                    </button>
                </div> *@

                <!-- Date Filter Section (full width, toggled on click) -->
                <div class="row mb-3" id="dateFilterContainer" style="display: none;">
                    <div class="col-md-3">
                        <input type="text" id="startDate" class="form-control" placeholder="@SharedResource.Start_Date">
                    </div>
                    <div class="col-md-3">
                        <input type="text" id="endDate" class="form-control" placeholder="@SharedResource.End_Date">
                    </div>
                </div>

                <div class="table-responsive">
                    
                    </div>
                </div>
            </div>
        </div>

  
    </div>
