
@model GittBilSmsCore.ViewModels.UserIndexViewModel

@{
    ViewData["Title"] = "Create User";
    var roles = ViewBag.Roles as List<GittBilSmsCore.Models.Role>;
}

 
<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <form id="userAddform" method="post" autocomplete="off">
                <div class="modal-header">
                    <h5 class="modal-title" id="addUserModalLabel"># @SharedResource.New_User</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <div class="row g-4">
                        <div class="col-lg-7">
                            <div class="mb-3">
                                <label asp-for="NewUser.FullName" class="form-label">@SharedResource.Name</label>
                                <input asp-for="NewUser.FullName" name="FullName" class="form-control" required placeholder="Name" />
                            </div>
                            <div class="mb-3">
                                <label asp-for="NewUser.UserName" class="form-label">@SharedResource.User_name</label>
                                <input asp-for="NewUser.UserName" name="UserName" class="form-control" required placeholder="User name" />
                            </div>
                            <div class="mb-3">
                                <label asp-for="NewUser.Email" class="form-label">@SharedResource.Email</label>
                                <input asp-for="NewUser.Email" name="Email" type="email" class="form-control" required placeholder="Email" />
                            </div>
                            <div class="mb-3">
                                <label asp-for="NewUser.PhoneNumber" class="form-label">@SharedResource.Telephone</label>
                                <input asp-for="NewUser.PhoneNumber" name="PhoneNumber" class="form-control phoneNumberinput" placeholder="(5__) ___ __ __" />
                            </div>
                            
                            <div class="mb-3">
                                <label for="Password" class="form-label">@SharedResource.Password</label>
                                <div class="input-group" id="show_hide_password">

                                    <button type="button" class="btn btn-success password-generator" data-password-target="Password">
                                        <i class="bi bi-arrow-clockwise"></i>
                                    </button>
                                    <input type="password" class="form-control" id="Password" name="Password" required autocomplete="new-password" />
                                    <a href="javascript:;" class="input-group-text bg-transparent"><i class="bi bi-eye-slash-fill"></i></a>
                                </div>
                                <small class="form-text text-muted">
                                    @SharedResource.Password_Information
                                </small>
                            </div>
                        </div>

                        <div class="col-lg-5">
                            <label class="form-label fw-bold mb-2">@SharedResource.Roles</label>
                            <div class="border rounded p-3">
                                @if (Model.Roles != null && Model.Roles.Any())
                                {
                                    @foreach (var role in Model.Roles)
                                    {
                                        var isDefault = role.RoleName == "User";
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" name="selectedRoles" value="@role.RoleId" id="role_@role.RoleId" @(isDefault ? "checked" : "") />
                                            <label class="form-check-label fw-semibold" for="role_@role.RoleId">@role.RoleName</label>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <div class="text-danger">@SharedResource.No_roles_found_</div>
                                }
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">@SharedResource.Create</button>
                   @*  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">@SharedResource.Cancel</button> *@
                    <a href="/Users/Index" class="btn btn-secondary">
                        @SharedResource.Cancel
                    </a>
                </div>
            </form>
        </div>
</div>
</div>
@using System.Text.Json 

@section Scripts {
    <script>
        $(function () {
          var type  = "@(ViewBag.ToastrType ?? "")";
          var title = @Html.Raw(JsonSerializer.Serialize(ViewBag.ToastrTitle ?? ""));
          var msg   = @Html.Raw(JsonSerializer.Serialize(ViewBag.ToastrMessage ?? ""));
          var redirectUrl   = @Html.Raw(JsonSerializer.Serialize(ViewBag.RedirectUrl ?? ""));
          var redirectDelay = @Html.Raw(JsonSerializer.Serialize(ViewBag.RedirectDelay ?? 0));

          if (type && msg) {
            toastr.options = {
              closeButton: true,
              progressBar: true,
              timeOut: (type === "success" ? 3000 : 5000),
              positionClass: "toast-bottom-right"
            };
            if (toastr[type]) toastr[type](msg, title); else toastr.info(msg, title);

            // Only redirect when success AND we have a URL
            if (type === "success" && redirectUrl) {
              setTimeout(function(){ window.location.href = redirectUrl; }, redirectDelay || 3000);
            }
          }
        });
    </script>
}



 


